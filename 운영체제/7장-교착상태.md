# 교착상태(deadlock)

![img](https://blog.kakaocdn.net/dn/EPwpV/btrf5iK32SP/8WjvMhUGTgb2fjCSNeZQN0/img.png)

위의 사진처럼 자신의 길을 점유하고있으면서 아무도 양보안한다면 계속 이러한 상태가 되는 상태

Deadlock

- 일련의 프로세스들이 서로가 가진 자원을 기다리며 Block된 상태

Resource(자원)

- 하드웨어, 소프트웨어 등을 포함하는 개념
-  I/O device,CPU cycle, memory space, semaphore등

Deadlock 예시

![img](https://blog.kakaocdn.net/dn/CQY2E/btrf3xO2dR0/y0mnSuYasaeHdoFJ6oIuG1/img.png)

 P0은 P(A)를 점유하고 P1은 P(B)를 점유하고있을 때에 P0이 P(B)를 할때 P1이 가지고 있고 P1이 P(A)를하려할 떄 P0이 가지고 있어 서로 못가져가는 상황

# Deadlock 발생의 4가지조건

![img](https://blog.kakaocdn.net/dn/un8QI/btrf5idfgBe/KNlC1VA3SmhMNuSSLeG2YK/img.png)

# Dedlock의 처리방법

![img](https://blog.kakaocdn.net/dn/dTq3eE/btrfURBMPaU/68uPASeQ4LsZC1gO7sy68k/img.png)

위에 2개가 미연에 방지하는방식 밑에 두개는 발생하고난 뒤 처리하는 방식



# Deadlock Prevetion

4가지 필요 조건중 하나를 만족되지 않도록 하는방식

![img](https://blog.kakaocdn.net/dn/bOiiSi/btrfWaA0Cma/Sx3OQiq6ghO7HX3DTKL7zK/img.png)

Hold and wait:자진해서 반납함으로 문제를 해결

No Preemption:자원을 선점 할 수 있게 설정하여 해결

- 아무렇게나 자원을 빼앗아 오면 문제가 생기지만,CPU와memory는 쉽게 save하고 restore를 할 수 있어 허용합니다.

Circular Wait:자원에 순서를 할당 하여 해결

- 획득 순서를 걸어놓아서 순서에 따라 자원을 얻도록 하므로 해결

이방법들은 원천적으로 Deadlock를 해결할 순 있지만 생기지도 않을 데드락을 생각해서 제약조건을 많이 달아놓으므로 비효율적입니다.

# Deadlock Avoidance

평생 사용할  최대의 자원들을 선언하여 만약 데드락의 위험생이 생길 것 같다면 자원을 내주지 않는 방식

# DeadlockDetection and Recovery

먼저 시스템이 데드락 예방이나 회피법을 사용하지 않았을 때, 데드락이 발생할 수 있으니 여기에서 회복하기 위해 **데드락을 탐지하고, 회복하는 알고리즘**을 사용합니다.

- 탐지 기법

  - Allocation, Request, Available 등으로 시스템에 **데드락이 발생했는지 여부를 탐색**합니다. 즉, 은행원 알고리즘에서 했던 방식과 유사하게 현재 시스템의 자원 할당 상태를 가지고 파악합니다.
  - 이 외에도 **자원 할당 그래프를 통해 탐지**하는 방법도 있습니다.

- **회복 기법**

  데드락을 탐지 기법을 통해 발견했다면, **`순환 대기`에서 벗어나 데드락으로부터 회복하기 위한 방법**을 사용합니다.

  - 단순히 프로세스를 1개 이상 중단시키기
    - **교착 상태에 빠진 모든 프로세스를 중단시키는 방법** : 계속 연산중이던 프로세스들도 모두 일시에 중단되어 부분 결과가 폐기될 수 있는 부작용이 발생할 수 있음
    - **프로세스를 하나씩 중단 시킬 때마다 탐지 알고리즘으로 데드락을 탐지하면서 회복시키는 방법** : 매번 탐지 알고리즘을 호출 및 수행해야 하므로 부담이 되는 작업일 수 있음
  - 자원 선점하기
    - 프로세스에 할당된 자원을 선점해서, 교착 상태를 해결할 때까지 그 자원을 다른 프로세스에 할당해 주는 방법



# Deadlock Igonorace

- 아무런 조치를 취하지 않음
- 매우 드물게 발생하는 Deadlock에 대한 조치는 오히려 더 많은 오버헤드 발생
- 대부분의 OS에서 채택
